"use strict";(globalThis.webpackChunkcluster_factory_ce_docs=globalThis.webpackChunkcluster_factory_ce_docs||[]).push([[7514],{2501:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"main-concepts/apps/slurm","title":"SLURM, A Highly Scalable Workload Manager","description":"Slurm is an open-source cluster resource management and job scheduling system.","source":"@site/docs/main-concepts/04-apps/08-slurm.md","sourceDirName":"main-concepts/04-apps","slug":"/main-concepts/apps/slurm","permalink":"/docs/main-concepts/apps/slurm","draft":false,"unlisted":false,"editUrl":"https://github.com/deepsquare-io/ClusterFactory/tree/main/web/docs/main-concepts/04-apps/08-slurm.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{},"sidebar":"docs","previous":{"title":"Grendel, the Bare-Metal Provisioner","permalink":"/docs/main-concepts/apps/grendel"},"next":{"title":"CernVM-FS, A Scalable, Distributed Read-Only File-System","permalink":"/docs/main-concepts/apps/cvmfs"}}');var t=s(2714),o=s(8885);const i={},c="SLURM, A Highly Scalable Workload Manager",a={},l=[{value:"Architecture",id:"architecture",level:2},{value:"Why Slurm ?",id:"why-slurm-",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"slurm-a-highly-scalable-workload-manager",children:"SLURM, A Highly Scalable Workload Manager"})}),"\n",(0,t.jsx)(n.p,{children:"Slurm is an open-source cluster resource management and job scheduling system."}),"\n",(0,t.jsx)(n.p,{children:"Slurm has three key features:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Resources Scheduling"}),": Allocation of exclusive and/or non-exclusive access to resources (compute nodes) to users for some duration of time."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Workload Management"}),": Ability to start, execute and monitor parallel jobs."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Queue Management"}),": Efficient handling of pending work by using the backfill scheduling algorithm."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,t.jsx)(n.p,{children:"The architecture is the following:"}),"\n",(0,t.jsx)("div",{style:{textAlign:"center"},children:(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"slurm concepts",src:s(6870).A+"#invert-on-dark",width:"414",height:"443"})})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"The client/login node"})," can send commands to the ",(0,t.jsx)(n.strong,{children:"Slurm controller daemon (slurmctld)"}),"\n(and directly to a compute node in case of a ",(0,t.jsx)(n.a,{href:"https://slurm.schedmd.com/srun.html",children:"srun job"}),").\nEach controller manages a cluster of ",(0,t.jsx)(n.strong,{children:"computer nodes (slurmd)"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Finally, there is eventually a ",(0,t.jsx)(n.strong,{children:"slurm database daemon (slurmdbd)"})," to manage the accounting data."]}),"\n",(0,t.jsx)(n.p,{children:"The main commands to know are the following:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"srun"}),": submit and execute a job in real-time. The job can be interactive too (similarly to ",(0,t.jsx)(n.code,{children:"docker run -it"}),")!"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"sbatch"}),": submit a job script for later execution. The script contains one or more srun commands to launch parallel tasks."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"scancel"}),": cancel a job."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"sinfo"}),": reports the state of partitions (group of nodes) and nodes of a cluster."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"squeue"}),": reports the state of the jobs."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"scontrol"}),": modify the Slurm cluster state (can only be run by root)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"sacct"}),": reports the jobs accounting information from the Slurm database."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"sacctmgr"}),": modify the Slurm database, including Slurm account information"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"why-slurm-",children:"Why Slurm ?"}),"\n",(0,t.jsxs)(n.p,{children:["By itself, Slurm can be replaced with solutions like ",(0,t.jsx)(n.a,{href:"https://adaptivecomputing.com/cherry-services/torque-resource-manager/",children:"Torque"}),", ",(0,t.jsx)(n.a,{href:"https://www.ibm.com/products/hpc-workload-management",children:"Spectrum LSF"}),", or even the ",(0,t.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/scheduling-eviction/kube-scheduler/",children:"Kubernetes Scheduler"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["The reason we are using Slurm is mainly because of the support of plugins, more precisely ",(0,t.jsx)(n.a,{href:"https://github.com/NVIDIA/pyxis",children:"NVIDIA Pyxis SPANK plugin"}),". Pyxis uses NVIDIA Enroot to run Slurm jobs with Docker/Singularity images."]}),"\n",(0,t.jsx)(n.p,{children:"NVIDIA Enroot is very similar to Docker. The main difference is that it runs containers (and OS images) in unprivileged sandboxes. Enroot also has built-in GPU support, which means we can run Slurm tasks with container images designed for GPUs (like Tensorflow, NVIDIA container images)."}),"\n",(0,t.jsx)(n.p,{children:"The resource management feature of Slurm is also quite powerful to make sure users doesn't consume too many resources."}),"\n",(0,t.jsx)(n.p,{children:"However, although Slurm is powerful, it has its drawbacks. For example, the REST API is not stable and the documentation is not precise enough for a user-friendly experience. Also, since Slurm is programmed in C, we had problems with memory leaks (which were fixed in version 21.08.7)."}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://oar.imag.fr",children:"OAR"}),", a job scheduler based on Perl (the v3 will be based on Python), could be a valid alternative/addition."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},6870:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/slurm.drawio-ca6ec7402ce5cf74f547e298c5e3faad.png"},8885:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>c});var r=s(9378);const t={},o=r.createContext(t);function i(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);